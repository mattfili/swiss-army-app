'use strict';

angular.module('swiss').factory('Weather', function (WeatherData, $http, $stateParams) {
  return {

    date: function date() {
      var day = new Date().toDateString().substring(0, 3);
      var month = new Date().toDateString().substring(3);
      if (day === 'Tue') {
        day = 'Tuesday';
      } else if (day === 'Wed') {
        day = 'Wednesday';
      } else if (day === 'Thur') {
        day = 'Thursday';
      } else if (day === 'Fri') {
        day = 'Friday';
      } else if (day === 'Sat') {
        day = 'Saturday';
      } else if (day === 'Sun') {
        day = 'Sunday';
      } else if (day === 'Mon') {
        day = 'Monday';
      }
      var datemonth = day + ',' + month;

      WeatherData.formatdate = datemonth;
    },

    getWeather: function getWeather() {
      $http.jsonp('/api/forecast/' + $stateParams.lat + ',' + $stateParams.long + '?callback=JSON_CALLBACK').success(function (data) {

        WeatherData.dataPush(data.currently, data.daily, data.hourly);

        var iconFrame = data.hourly.data;

        for (var i = 0; i < iconFrame.length; i++) if (iconFrame[i].icon === 'clear-day') {
          WeatherData.iconPush('sun.svg', i);
        } else if (iconFrame[i].icon === 'clear-night') {
          WeatherData.iconPush('moonPhase.svg', i);
        } else if (iconFrame[i].icon === 'rain' && iconFrame[i].summary === 'Rain') {
          WeatherData.iconPush('cloudRain.svg', i);
        } else if (iconFrame[i].summary === 'Light Rain') {
          WeatherData.iconPush('cloudDrizzleAlt.svg', i);
        } else if (iconFrame[i].icon === 'rain' && iconFrame[i].summary === 'Drizzle') {
          WeatherData.iconPush('cloudDrizzle.svg', i);
        } else if (iconFrame[i].icon === 'snow') {
          WeatherData.iconPush('cloudSnow.svg', i);
        } else if (iconFrame[i].icon === 'sleet') {
          WeatherData.iconPush('cloudSnowAlt.svg', i);
        } else if (iconFrame[i].icon === 'wind') {
          WeatherData.iconPush('wind.svg', i);
        } else if (iconFrame[i].icon === 'fog') {
          WeatherData.iconPush('cloudFog.svg', i);
        } else if (iconFrame[i].icon === 'cloudy') {
          WeatherData.iconPush('cloud.svg', i);
        } else if (iconFrame[i].icon === 'partly-cloudy-day') {
          WeatherData.iconPush('cloudSun.svg', i);
        } else if (iconFrame[i].icon === 'partly-cloudy-night') {
          WeatherData.iconPush('cloudMoon.svg', i);
        }

        var colorTime = data.hourly.data;

        for (var i = 0; i < colorTime.length; i++) {
          var unUnixDate = new Date(colorTime[i].time * 1000);
          var formattedDate = unUnixDate.getHours();

          if (formattedDate >= 0 && formattedDate <= 2 || formattedDate === 23) {
            WeatherData.colorPush('#071826', i);
          } else if (formattedDate >= 3 && formattedDate <= 5) {
            WeatherData.colorPush('#071940', i);
          } else if (formattedDate === 6) {
            WeatherData.colorPush('#FA6551', i);
          } else if (formattedDate >= 7 && formattedDate <= 11) {
            WeatherData.colorPush('#2A91CF', i);
          } else if (formattedDate >= 12 && formattedDate <= 15) {
            WeatherData.colorPush('#9DDEFF', i);
          } else if (formattedDate >= 16 && formattedDate <= 18) {
            WeatherData.colorPush('#2A91CF', i);
          } else if (formattedDate === 19) {
            WeatherData.colorPush('#FA6A67', i);
          } else if (formattedDate >= 20 && formattedDate <= 22) {
            WeatherData.colorPush('#133778', i);
          }
        }
      });
    }

  };
}).filter('Time', function () {
  return function (input) {
    var unUnixDate = new Date(input * 1000);
    var formattedDate = unUnixDate.getHours();
    if (formattedDate <= 23 && formattedDate >= 13) {
      var output = formattedDate - 12 + 'pm';
    } else if (formattedDate === 0) {
      var output = formattedDate + 12 + 'am';
    } else if (formattedDate === 12) {
      var output = formattedDate + 'pm';
    } else {
      var output = formattedDate + 'am';
    }
    return output;
  };
}).filter('Percent', function () {
  return function (input) {
    var output = input * 100;
    return output + '%';
    console.log(output);
  };
});
//# sourceMappingURL=data:application/json;base64,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QUcsQ0FBQTtBQUN4QixXQUFPLE1BQU0sR0FBRyxHQUFHLENBQUE7QUFDbkIsV0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtHQUN0QixDQUFBO0NBQ0EsQ0FBQyxDQUFBIiwiZmlsZSI6InNyYy9qcy9mYWN0b3J5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ3N3aXNzJylcblxuLmZhY3RvcnkoJ1dlYXRoZXInLCBmdW5jdGlvbiAoIFdlYXRoZXJEYXRhLCAkaHR0cCwgJHN0YXRlUGFyYW1zKSB7XG5yZXR1cm4ge1xuXG4gIGRhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBkYXkgPSBuZXcgRGF0ZSgpLnRvRGF0ZVN0cmluZygpLnN1YnN0cmluZygwLCAzKVxuICAgIHZhciBtb250aCA9IG5ldyBEYXRlKCkudG9EYXRlU3RyaW5nKCkuc3Vic3RyaW5nKDMpXG4gICAgaWYgKGRheSA9PT0gJ1R1ZScpIHtcbiAgICAgIGRheSA9ICdUdWVzZGF5J1xuICAgIH0gZWxzZSBpZiAoZGF5ID09PSdXZWQnKSB7XG4gICAgICBkYXkgPSAnV2VkbmVzZGF5J1xuICAgIH0gZWxzZSBpZiAoZGF5ID09PSdUaHVyJykge1xuICAgICAgZGF5ID0gJ1RodXJzZGF5J1xuICAgIH0gZWxzZSBpZiAoZGF5ID09PSdGcmknKSB7XG4gICAgICBkYXkgPSAnRnJpZGF5J1xuICAgIH0gZWxzZSBpZiAoZGF5ID09PSdTYXQnKSB7XG4gICAgICBkYXkgPSAnU2F0dXJkYXknXG4gICAgfSBlbHNlIGlmIChkYXkgPT09J1N1bicpIHtcbiAgICAgIGRheSA9ICdTdW5kYXknXG4gICAgfSBlbHNlIGlmIChkYXkgPT09J01vbicpIHtcbiAgICAgIGRheSA9ICdNb25kYXknXG4gICAgfVxuICAgIHZhciBkYXRlbW9udGggPSBkYXkgKyAnLCcgKyBtb250aFxuXG4gICAgV2VhdGhlckRhdGEuZm9ybWF0ZGF0ZSA9IGRhdGVtb250aFxuICB9LFxuXG4gIGdldFdlYXRoZXI6IGZ1bmN0aW9uKCkge1xuICAgICRodHRwXG4gICAgICAuanNvbnAoJy9hcGkvZm9yZWNhc3QvJyArICRzdGF0ZVBhcmFtcy5sYXQgKyAnLCcgKyAkc3RhdGVQYXJhbXMubG9uZyArICc/Y2FsbGJhY2s9SlNPTl9DQUxMQkFDSycpXG4gICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSl7XG5cbiAgICAgICAgV2VhdGhlckRhdGEuZGF0YVB1c2goZGF0YS5jdXJyZW50bHksIGRhdGEuZGFpbHksIGRhdGEuaG91cmx5KSBcbiAgICAgICAgXG4gICAgICAgIHZhciBpY29uRnJhbWUgPSBkYXRhLmhvdXJseS5kYXRhXG5cblxuXG4gICAgICAgIGZvciAodmFyIGkgPTA7IGkgPCBpY29uRnJhbWUubGVuZ3RoOyBpKyspXG5cbiAgICAgICAgICBpZiAoaWNvbkZyYW1lW2ldLmljb24gID09PSAnY2xlYXItZGF5Jykge1xuICAgICAgICAgICAgV2VhdGhlckRhdGEuaWNvblB1c2goJ3N1bi5zdmcnLCBpKVxuXG4gICAgICAgICAgfSBlbHNlIGlmIChpY29uRnJhbWVbaV0uaWNvbiA9PT0nY2xlYXItbmlnaHQnKSB7XG4gICAgICAgICAgICBXZWF0aGVyRGF0YS5pY29uUHVzaCgnbW9vblBoYXNlLnN2ZycsIGkpXG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGljb25GcmFtZVtpXS5pY29uID09PSdyYWluJyAmJiBpY29uRnJhbWVbaV0uc3VtbWFyeT09PSdSYWluJykge1xuICAgICAgICAgICAgV2VhdGhlckRhdGEuaWNvblB1c2goJ2Nsb3VkUmFpbi5zdmcnLCBpKVxuXG4gICAgICAgICAgfSBlbHNlIGlmIChpY29uRnJhbWVbaV0uc3VtbWFyeSA9PT0gJ0xpZ2h0IFJhaW4nKSB7XG4gICAgICAgICAgICBXZWF0aGVyRGF0YS5pY29uUHVzaCgnY2xvdWREcml6emxlQWx0LnN2ZycsIGkpXG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGljb25GcmFtZVtpXS5pY29uID09PSAncmFpbicgJiYgaWNvbkZyYW1lW2ldLnN1bW1hcnk9PT0nRHJpenpsZScpIHtcbiAgICAgICAgICAgIFdlYXRoZXJEYXRhLmljb25QdXNoKCdjbG91ZERyaXp6bGUuc3ZnJywgaSlcblxuICAgICAgICAgIH0gZWxzZSBpZiAoaWNvbkZyYW1lW2ldLmljb24gPT09J3Nub3cnKSB7XG4gICAgICAgICAgICBXZWF0aGVyRGF0YS5pY29uUHVzaCgnY2xvdWRTbm93LnN2ZycsIGkpXG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGljb25GcmFtZVtpXS5pY29uID09PSdzbGVldCcpIHtcbiAgICAgICAgICAgIFdlYXRoZXJEYXRhLmljb25QdXNoKCdjbG91ZFNub3dBbHQuc3ZnJywgaSlcblxuICAgICAgICAgIH0gZWxzZSBpZiAoaWNvbkZyYW1lW2ldLmljb24gPT09J3dpbmQnKSB7XG4gICAgICAgICAgICBXZWF0aGVyRGF0YS5pY29uUHVzaCgnd2luZC5zdmcnLCBpKVxuXG4gICAgICAgICAgfSBlbHNlIGlmIChpY29uRnJhbWVbaV0uaWNvbiA9PT0nZm9nJykge1xuICAgICAgICAgICAgV2VhdGhlckRhdGEuaWNvblB1c2goJ2Nsb3VkRm9nLnN2ZycsIGkpXG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGljb25GcmFtZVtpXS5pY29uID09PSdjbG91ZHknKSB7XG4gICAgICAgICAgICBXZWF0aGVyRGF0YS5pY29uUHVzaCgnY2xvdWQuc3ZnJywgaSlcblxuICAgICAgICAgIH0gZWxzZSBpZiAoaWNvbkZyYW1lW2ldLmljb24gPT09J3BhcnRseS1jbG91ZHktZGF5Jykge1xuICAgICAgICAgICAgV2VhdGhlckRhdGEuaWNvblB1c2goJ2Nsb3VkU3VuLnN2ZycsIGkpXG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGljb25GcmFtZVtpXS5pY29uID09PSdwYXJ0bHktY2xvdWR5LW5pZ2h0Jykge1xuICAgICAgICAgICAgV2VhdGhlckRhdGEuaWNvblB1c2goJ2Nsb3VkTW9vbi5zdmcnLCBpKVxuICAgICAgICAgIH1cblxuICAgICAgICBcblxuICAgICAgICB2YXIgY29sb3JUaW1lID0gZGF0YS5ob3VybHkuZGF0YVxuXG4gICAgICAgIGZvciAodmFyIGk9MDsgaSA8IGNvbG9yVGltZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciB1blVuaXhEYXRlID0gbmV3IERhdGUoY29sb3JUaW1lW2ldLnRpbWUgKjEwMDApXG4gICAgICAgICAgdmFyIGZvcm1hdHRlZERhdGUgPSB1blVuaXhEYXRlLmdldEhvdXJzKCk7XG5cbiAgICAgICAgaWYgKGZvcm1hdHRlZERhdGUgPj0gMCAmJiBmb3JtYXR0ZWREYXRlIDw9MiB8fCBmb3JtYXR0ZWREYXRlID09PSAyMykge1xuICAgICAgICAgICAgV2VhdGhlckRhdGEuY29sb3JQdXNoKCcjMDcxODI2JywgaSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChmb3JtYXR0ZWREYXRlID49MyAmJiBmb3JtYXR0ZWREYXRlIDw9IDUpe1xuICAgICAgICAgICAgV2VhdGhlckRhdGEuY29sb3JQdXNoKCcjMDcxOTQwJywgaSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChmb3JtYXR0ZWREYXRlID09PSA2ICl7XG4gICAgICAgICAgICBXZWF0aGVyRGF0YS5jb2xvclB1c2goJyNGQTY1NTEnLCBpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdHRlZERhdGUgPj0gNyAmJiBmb3JtYXR0ZWREYXRlIDw9MTEgKXtcbiAgICAgICAgICAgIFdlYXRoZXJEYXRhLmNvbG9yUHVzaCgnIzJBOTFDRicsIGkpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0dGVkRGF0ZSA+PSAxMiAmJiBmb3JtYXR0ZWREYXRlIDw9IDE1KXtcbiAgICAgICAgICAgIFdlYXRoZXJEYXRhLmNvbG9yUHVzaCgnIzlEREVGRicsIGkpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0dGVkRGF0ZSA+PSAxNiAmJiBmb3JtYXR0ZWREYXRlIDw9IDE4KXtcbiAgICAgICAgICAgIFdlYXRoZXJEYXRhLmNvbG9yUHVzaCgnIzJBOTFDRicsIGkpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0dGVkRGF0ZSA9PT0gMTkpe1xuICAgICAgICAgICAgV2VhdGhlckRhdGEuY29sb3JQdXNoKCcjRkE2QTY3JywgaSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChmb3JtYXR0ZWREYXRlID49IDIwICYmIGZvcm1hdHRlZERhdGUgPD0gMjIpe1xuICAgICAgICAgICAgV2VhdGhlckRhdGEuY29sb3JQdXNoKCcjMTMzNzc4JywgaSk7XG4gICAgICAgICAgfSBcbiAgICAgIH1cblxuICAgIH0pXG5cblxuICB9XG5cbn1cbn0pXG5cbi5maWx0ZXIoJ1RpbWUnLCBmdW5jdGlvbiAoKSB7XG5yZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICB2YXIgdW5Vbml4RGF0ZSA9IG5ldyBEYXRlKGlucHV0KjEwMDApXG4gICAgdmFyIGZvcm1hdHRlZERhdGUgPSB1blVuaXhEYXRlLmdldEhvdXJzKCk7XG4gICAgICBpZiAoZm9ybWF0dGVkRGF0ZSA8PSAyMyAmJiBmb3JtYXR0ZWREYXRlID49IDEzKSB7XG4gICAgICAgIHZhciBvdXRwdXQgPSBmb3JtYXR0ZWREYXRlLTEyICsgJ3BtJ1xuICAgICAgfSBlbHNlIGlmIChmb3JtYXR0ZWREYXRlID09PSAwKXtcbiAgICAgICAgdmFyIG91dHB1dCA9IGZvcm1hdHRlZERhdGUrMTIgKyAnYW0nXG4gICAgICB9IGVsc2UgaWYgKGZvcm1hdHRlZERhdGUgPT09IDEyKXtcbiAgICAgICAgdmFyIG91dHB1dCA9IGZvcm1hdHRlZERhdGUgKyAncG0nXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgb3V0cHV0ID0gZm9ybWF0dGVkRGF0ZSArICdhbSdcbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxufSlcblxuLmZpbHRlcignUGVyY2VudCcsIGZ1bmN0aW9uICgpIHtcbnJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgIHZhciBvdXRwdXQgPSBpbnB1dCAqIDEwMFxuICAgIHJldHVybiBvdXRwdXQgKyAnJSdcbiAgICBjb25zb2xlLmxvZyhvdXRwdXQpXG59XG59KSJdfQ==
